<% title = 'Edit Admin' %>

<!-- External CSS and JS -->
<link rel="stylesheet" href="/css/editAdmin.css">
<link rel="stylesheet" href="/css/toast.css">
<script src="/js/passwordToggle.js" defer></script>
<script src="/js/toast.js" defer></script>

<!-- Flash Messages Meta Tags -->
<% if (typeof error !== 'undefined' && error.length > 0) { %>
  <meta name="flash-error" content="<%= error %>">
<% } %>

<div class="container-fluid mt-4">
  <!-- Header Section -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h1 class="h2 mb-0">
            <i class="fas fa-user-edit text-primary me-2"></i>
            Edit Admin
          </h1>
          <p class="text-muted mb-0">Update admin information and permissions</p>
        </div>
        <div class="d-flex align-items-center">
          <span class="badge bg-success fs-6 me-3">
            <i class="fas fa-crown me-1"></i>Superadmin Access
          </span>
          <a href="/admin/admins" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-2"></i>Back to Admin Management
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Admin Form -->
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-white border-0">
          <h5 class="mb-0">
            <i class="fas fa-user-edit text-info me-2"></i>
            Edit Admin: <%= admin.name %>
          </h5>
        </div>
        <div class="card-body">
          <form action="/admin/admins/edit/<%= admin.id %>" method="POST" class="row g-3">
            <div class="col-md-6">
              <label for="adminName" class="form-label">Full Name</label>
              <input
                type="text"
                class="form-control"
                id="adminName"
                name="name"
                value="<%= admin.name %>"
                required
                placeholder="Enter admin's full name"
              />
            </div>
            <div class="col-md-6">
              <label for="adminEmail" class="form-label">Email Address</label>
              <input
                type="email"
                class="form-control"
                id="adminEmail"
                name="email"
                value="<%= admin.email %>"
                required
                placeholder="Enter admin's email"
              />
            </div>
            <div class="col-md-6">
              <label for="adminPassword" class="form-label">Password</label>
              <div class="input-group">
                <input
                  type="password"
                  class="form-control"
                  id="adminPassword"
                  name="password"
                  placeholder="Leave blank to keep current password"
                  minlength="6"
                />
                <button
                  class="btn btn-outline-secondary"
                  type="button"
                  id="togglePassword"
                  title="Show/Hide Password"
                >
                  <i class="fas fa-eye" id="passwordIcon"></i>
                </button>
              </div>
              <div class="form-text">
                <i class="fas fa-info-circle me-1"></i>
                Leave password field empty to keep the current password unchanged
              </div>
            </div>
            <div class="col-md-6">
              <label for="adminRole" class="form-label">Role</label>
              <select class="form-select" id="adminRole" name="role" required <%= admin.id === user.id ? 'disabled title="You cannot change your own role"' : '' %>>
                <option value="admin" <%= admin.role === 'admin' ? 'selected' : '' %>>Admin</option>
                <option value="superadmin" <%= admin.role === 'superadmin' ? 'selected' : '' %>>Superadmin</option>
              </select>
              <% if (admin.id === user.id) { %>
                <div class="form-text text-danger">
                  <i class="fas fa-info-circle me-1"></i>
                  You cannot change your own role.
                </div>
              <% } %>
            </div>
            
            <!-- Current Admin Info -->
            <div class="col-12">
              <div class="alert alert-info">
                <h6 class="alert-heading">
                  <i class="fas fa-info-circle me-2"></i>
                  Current Admin Information
                </h6>
                <div class="row">
                  <div class="col-md-6">
                    <strong>Name:</strong> <%= admin.name %><br>
                    <strong>Email:</strong> <%= admin.email %>
                  </div>
                  <div class="col-md-6">
                    <strong>Role:</strong> 
                    <% if (admin.role === 'superadmin') { %>
                      <span class="badge bg-success">
                        <i class="fas fa-crown me-1"></i>Superadmin
                      </span>
                    <% } else { %>
                      <span class="badge bg-primary">
                        <i class="fas fa-user me-1"></i>Admin
                      </span>
                    <% } %>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-12">
              <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save me-2"></i>
                  Update Admin
                </button>
                <a href="/admin/admins" class="btn btn-outline-secondary">
                  <i class="fas fa-times me-2"></i>
                  Cancel
                </a>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div> 